<?php
require_once(dirname(__FILE__).'/inc/config.inc.php');IsModelPriv('admanage');
include("sendmessage.php");
$appid=$cfg_appid;
$appsecret=$cfg_appsecret;
$code="011ZW5ci0uBaip1Xfmei0Tpcci0ZW5cJ";
$openid=get_openid($code,$appid,$appsecret);
// echo $openid;

 //获取ajax传来的base64编码，$_POST['img']是你后台获取到的图片
$base64_image_content = "data:image/png;base64,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";

//图片保存的位置
$path= './public/upload/';
//这个是自定义函数，将Base64图片转换为本地图片并保存
$data = base64_image_content($base64_image_content,$path);
echo $data;

function base64_image_content($base64_image_content,$path){
   //匹配出图片的格式
    if (preg_match('/^(data:\s*image\/(\w+);base64,)/',
    $base64_image_content, $result)){ //后缀
    $type = $result[2]; //创建文件夹，以年月日
    $new_file = $path.date('Ymd',time())."/";
    if(!file_exists($new_file)){ //检查是否有该文件夹，如果没有就创建，并给予最高权限
    mkdir($new_file, 0700);
    } $new_file = $new_file.time().".{$type}"; //图片名以时间命名 //保存为文件
    if (file_put_contents($new_file, base64_decode(str_replace($result[1], '', $base64_image_content)))){
    //返回这个图片的路径
    return $new_file;
  }else{ return false; }
  }else{ return false; }
 }










?>
